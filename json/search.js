var obj = {
  preference: {
    value: "S",
  },
  agreement: {
    value: "2",
  },
  sharingCount: {
    value: "",
  },
  sharingType: {
    value: "",
  },
  tenantGender: {
    value: "",
  },
  suitableFor: {
    value: [],
  },
  availableFor: {
    value: [],
  },
  additionalRooms: {
    value: [],
  },
  waterSource: {
    value: [],
  },
  overlooking: {
    value: [],
  },
  powerBackup: {
    value: "",
  },
  amenities: {
    value: [],
  },
  bedroomNum: {
    value: "",
  },
  areaType: {},
  noticeDuration: {
    value: "",
  },
  furnish: {
    value: "",
  },
  parking: {
    value: 0,
  },
  facing: {
    value: "",
  },
  flooring: {
    value: "",
  },
  widthOfFacingRoad: {
    value: "",
  },
  callPreference: {
    value: [],
  },
  callPreferencetext: {},
  updatedDescription: {},
  widthOfFacingRoadUnit: {
    value: "1",
  },
  bathroomNum: {
    value: "",
  },
  balconyNum: {
    value: "",
  },
  ownership: {
    value: "",
  },
  price: {
    value: "",
  },
  inclusive: {
    value: false,
  },
  taxGovtCharges: {
    value: false,
  },
  negotiable: {
    value: false,
  },
  electricityWaterCharges: {
    value: true,
  },
  propertyType: {
    value: 1,
  },
  resCom: {
    value: "R",
  },
  superPropertyType: {
    value: 1,
  },
  totalFloor: {
    value: "",
  },
  floorNum: {
    value: "",
  },
  areaUnit: {
    value: 1,
  },
  superBuiltup: {
    value: "",
  },
  builtup: {
    value: "",
  },
  carpet: {
    value: "",
  },
  age: {
    value: "",
  },
  openParking: {
    value: 0,
  },
  coveredParking: {
    value: 0,
  },
  propertyAvailability: {
    value: "",
  },
  availability: {},
  isBrokerage: {
    value: "",
  },
  brokerageType: {
    value: "FIXED_AMOUNT",
  },
  brokerage: {
    value: "",
  },
  brokerageNegotiable: {
    value: false,
  },
  maintenance: {
    value: "",
  },
  maintenanceCriteria: {
    value: "1",
  },
  expectedRental: {
    value: "",
  },
  bookingAmount: {
    value: "",
  },
  annualDues: {
    value: "",
  },
  membership: {
    value: "",
  },
  bedsNum: {
    value: "",
  },
  capacity: {
    value: "",
  },
  bathroomAttached: {
    value: false,
  },
  balconyAttached: {
    value: false,
  },
  earlyLeavingCharges: {
    value: "",
  },
  earlyLeavingChargesType: {
    value: "",
  },
  rentAgreementDuration: {},
  depositType: {
    value: "",
  },
  deposit: {
    value: "",
  },
  petAllowed: {
    value: "",
  },
  drinkingAllowed: {
    value: "",
  },
  smokingAllowed: {
    value: "",
  },
  visitorAllowed: {
    value: "",
  },
  partiesAllowed: {
    value: "",
  },
  lastEntryTime: {},
  otherRule: {},
  totalPriceIncludes: {
    value: [],
  },
  laundryAvailability: {
    value: "",
  },
  laundryCharge: {
    value: "",
  },
  laundryChargeType: {
    value: "FIXED",
  },
  waterAvailability: {
    value: "",
  },
  waterCharge: {
    value: "",
  },
  waterChargeType: {
    value: "FIXED",
  },
  wifiAvailability: {
    value: "",
  },
  wifiCharge: {
    value: "",
  },
  wifiChargeType: {
    value: "FIXED",
  },
  housekeepingAvailability: {
    value: "",
  },
  housekeepingCharge: {
    value: "",
  },
  housekeepingChargeType: {
    value: "FIXED",
  },
  electricityAvailability: {
    value: "",
  },
  electricityCharge: {
    value: "",
  },
  electricityChargeType: {
    value: "FIXED",
  },
  dthAvailability: {
    value: "",
  },
  dthCharge: {
    value: "",
  },
  dthChargeType: {
    value: "FIXED",
  },
  qualityRating: {
    value: "",
  },
  numberOfProperties: {
    value: "",
  },
  totalRooms: {
    value: "",
  },
  foodAvailability: {
    value: "",
  },
  foodType: {
    value: "",
  },
  foodAvailabilityWeekdays: {
    value: [],
  },
  foodAvailabilityWeekends: {
    value: [],
  },
  foodChargeType: {
    value: "",
  },
  foodCharge: {
    value: "",
  },
  breakfastCharge: {
    value: "",
  },
  lunchCharge: {
    value: "",
  },
  dinnerCharge: {
    value: "",
  },
  otherAmenities: {
    value: [],
  },
  propertyFeatures: {
    value: [],
  },
  societyFeatures: {
    value: [],
  },
  commonFurnish_diningTable: {
    value: false,
  },
  commonFurnish_Tv: {
    value: 0,
  },
  commonFurnish_washingMachine: {
    value: 0,
  },
  commonFurnish_Ac: {
    value: 0,
  },
  commonFurnish_sofa: {
    value: false,
  },
  commonFurnish_WaterPurfier: {
    value: false,
  },
  commonFurnish_ModularKitchen: {
    value: false,
  },
  commonFurnish_fans: {
    value: false,
  },
  commonFurnish_light: {
    value: 0,
  },
  commonFurnish_curtains: {
    value: false,
  },
  commonFurnish_fridge: {
    value: false,
  },
  commonFurnish_geyser: {
    value: false,
  },
  commonFurnish_stove: {
    value: false,
  },
  commonFurnish_microwave: {
    value: false,
  },
  commonFurnish_chimney: {
    value: false,
  },
  commonFurnish_exhaustFan: {
    value: false,
  },
  commonFurnish_wardrobe: {
    value: 0,
  },
  furnishing_Tv: {
    value: 0,
  },
  furnishing_Ac: {
    value: 0,
  },
  furnishing_Bed: {
    value: 0,
  },
  furnishing_Fan: {
    value: 0,
  },
  furnishing_Gey: {
    value: 0,
  },
  furnishing_Light: {
    value: 0,
  },
  furnishing_Ward: {
    value: 0,
  },
  furnishing_Chmny: {
    value: false,
  },
  furnishing_Curt: {
    value: false,
  },
  furnishing_Dinngtbl: {
    value: false,
  },
  furnishing_Exhstfn: {
    value: false,
  },
  furnishing_Kit: {
    value: false,
  },
  furnishing_Ref: {
    value: false,
  },
  furnishing_Sofa: {
    value: false,
  },
  furnishing_Stv: {
    value: false,
  },
  furnishing_Washmchn: {
    value: false,
  },
  furnishing_Wtrpurfr: {
    value: false,
  },
  furnishing_fan_toggle: {
    value: false,
  },
  furnishing_geyser_toggle: {
    value: false,
  },
  furnishing_studytable: {
    value: false,
  },
  furnishing_Microwave: {
    value: false,
  },
  availabilityMonth: {},
  superArea: {
    value: "",
  },
  minimumContractDuration: {},
  availabilityDate: {
    value: "",
  },
  propertySpecification: {
    value: "N",
  },
  minArea: {
    value: "",
  },
  maxArea: {
    value: "",
  },
  washroomNumber: {
    value: "",
  },
  plotLength: {
    value: "",
  },
  plotBreadth: {
    value: "",
  },
  isBoundaryWallMade: {
    value: "",
  },
  cornerProperty: {
    value: false,
  },
  wheelChairFriendly: {
    value: false,
  },
  petFriendly: {
    value: false,
  },
  withinGatedCommunity: {
    value: false,
  },
  pricePerUnitArea: {
    value: "",
  },
  availableRooms: {
    value: "",
  },
  priceRangeText: {},
  priceInWords: {},
  depositPriceInWords: {},
  depositMonthsInWords: {},
  meetingRoomsNum: {
    value: "",
  },
  minSeats: {
    value: "",
  },
  maxSeats: {
    value: "",
  },
  cabinsNum: {
    value: "",
  },
  receptionArea: {
    value: "",
  },
  washroomAvailable: {
    value: "",
  },
  privateWashrooms: {
    value: 0,
  },
  sharingWashrooms: {
    value: 0,
  },
  conferenceRoomsAvailable: {
    value: "",
  },
  conferenceRoomsCount: {
    value: "",
  },
  pantryType: {
    value: "",
  },
  pantryArea: {
    value: "",
  },
  pantryAreaUnit: {
    value: 1,
  },
  furnishingAvailable: {
    value: "",
  },
  centralAirConditioningAvailable: {
    value: "",
  },
  oxygenDuctAvailable: {
    value: "",
  },
  upsAvailable: {
    value: "",
  },
  fireSafetyMeasures: {
    value: [],
  },
  rentIncrement: {
    value: "",
  },
  fireNoc: {
    value: "",
  },
  occupancyCertificate: {
    value: "",
  },
  lockInPeriod: {
    value: "",
  },
  officeUsedFor: {
    value: [],
  },
  multiFloorSelect: {
    value: "",
  },
  multiFloorNum: {
    value: [],
  },
  staircaseNum: {
    value: "",
  },
  dgUpsPriceIncluded: {
    value: false,
  },
  wallsType: {
    value: "",
  },
  doorsAvailable: {
    value: "",
  },
  bareshellCentralAirConditioningAvailable: {
    value: "",
  },
  bsFlooring: {
    value: "",
  },
  commercialParkingAvailable: {
    value: "",
  },
  privateBasementParkingAvailable: {
    value: false,
  },
  privateOutsideParkingAvailable: {
    value: false,
  },
  publicParkingAvailable: {
    value: false,
  },
  parkingCount: {
    value: "",
  },
  liftsAvailable: {
    value: "",
  },
  passengerLifts: {
    value: 0,
  },
  serviceLifts: {
    value: 0,
  },
  modernLiftsAvailable: {
    value: false,
  },
  minimumLeasableSuperBuiltUp: {
    value: "",
  },
  priceType: {
    value: "FIXED",
  },
  hidePrice: {
    value: "",
  },
  minPrice: {
    value: "",
  },
  maxPrice: {
    value: "",
  },
  minPriceInWords: {},
  maxPriceInWords: {},
  verifyListing: {
    value: false,
  },
  uploadImage: {
    value: false,
  },
  reimburse: {
    value: false,
  },
  assuredReturns: {
    value: "",
  },
  leaseGuarantee: {
    value: "",
  },
  entranceWidth: {
    value: "",
  },
  ceilingHeight: {
    value: "",
  },
  entranceWidthUnit: {
    value: "1",
  },
  ceilingHeightUnit: {
    value: "1",
  },
  washroomTypes: {
    value: [],
  },
  parkingTypes: {
    value: [],
  },
  shopLocatedIn: {
    value: "",
  },
  isPreLeased: {
    value: "",
  },
  currentMonthlyRent: {
    value: "",
  },
  currentLeaseTenure: {
    value: "",
  },
  annualRentIncrease: {
    value: "",
  },
  leasedTo: {
    value: {},
  },
  expectedAnnualReturns: {
    value: "",
  },
  hideExpectedAnnualReturns: {
    value: false,
  },
  suitableBusinessType: {
    value: [],
  },
  otherSuitableBusinessType: {
    value: "",
  },
  locatedNear: {
    value: [],
  },
  mainRoadFacing: {
    value: false,
  },
  shopLocatedInOthers: {
    value: "",
  },
  city: {
    value: {
      id: "",
      label: "",
      lat: "",
      lng: "",
    },
  },
  locationState: {
    value: {
      id: "",
      label: "",
      lat: "",
      lng: "",
    },
  },
  locality: {
    value: {
      id: "",
      label: "",
      lat: "",
      lng: "",
    },
  },
  subLocality: {
    value: {
      id: "",
      label: "",
      lat: "",
      lng: "",
    },
  },
  project: {
    value: {
      id: "",
      label: "",
      lat: "",
      lng: "",
    },
  },
  tower: {
    value: {
      id: "",
      label: "",
      lat: "",
      lng: "",
    },
  },
  zoneType: {
    value: {
      id: "",
      label: "",
    },
  },
  locatedInside: {
    value: {
      id: "",
      label: "",
    },
  },
  address: {
    value: "",
  },
  latLng: {
    value: {
      lat: 28.653386,
      lng: 77.228165,
      field: "",
    },
  },
  floorPlanId: {
    value: "",
  },
  postedAs: {
    value: "O",
  },
  description: {
    value: "",
    isAutoGenerated: false,
    error: "",
    descriptionReviewed: false,
  },
  usps: [],
  perUnitArea: {
    value: "",
  },
  projectCoverPhoto: {
    coverPhoto: null,
  },
  expectedAnnualReturnsCriteria: {
    value: true,
  },
  locationAdvantages: [],
  suggestUsp: [],
  lastActiveUrl: "/postproperty",
  mediaUploadChannels: [],
  PriceRecommender: {
    loading: false,
    minPrice: "",
    maxPrice: "",
    totalPrice: "",
    price: "",
    pricingReasons: [],
    otherReasons: "",
    visible: false,
    isEdit: false,
  },
  visitedPages: {
    PrimaryDetails: true,
  },
  lastUpdatedField: "superPropertyType",
  CommercialProject: {
    projectData: {},
  },
  premiumVersion: {},
};

var myModalContent = `<button type="button" id="myModalOpen" class="btn btn-primary rounded-0 p-3" style="position: fixed;bottom: 0;right: 0;z-index: 9999;">Upload File</button>`;
var myModal = document.createElement("div");
myModal.innerHTML = myModalContent;
myModal.setAttribute("id", "myModal");

var area = 0;
if (window.location.href.indexOf("postproperty") > -1) {
  document.body.appendChild(myModal);
}

document.querySelector("#myModalOpen").addEventListener("click", function () {
  var input = document.createElement("input");
  input.setAttribute("type", "file");
  input.setAttribute("id", "myFile");
  input.setAttribute("accept", ".xlsx");
  input.setAttribute("style", "display: none;");
  document.body.appendChild(input);
  document.querySelector("#myFile").click();
  document.querySelector("#myFile").addEventListener("change", function () {
    var file = this.files[0];
    var reader = new FileReader();
    reader.readAsText(file);
    reader.onload = function (e) {
      var data = e.target.result;
      var workbook = XLSX.read(data, {
        type: "binary",
      });
      workbook.SheetNames.forEach(function (sheetName) {
        console.log(sheetName);
        var XL_row_object = XLSX.utils.sheet_to_row_object_array(
          workbook.Sheets[sheetName]
        );
        var json_object = JSON.stringify(XL_row_object);
        console.log(json_object);
      });
      var csv = e.target.result;
      var data = csv.split("\n");
      var dataArray = [];
      for (var i = 0; i < data.length; i++) {
        var datarow = data[i].split(",");
        dataArray.push(datarow);
      }
      dataArray.forEach(function (datarow) {
        try {
          if (datarow[0] === "") {
            return;
          }
          // datarow[0].toLowerCase().replaceAll("\r", "");
          // datarow[1].toLowerCase().replaceAll("\r", "");
          datarow[1] =
            datarow[1][datarow[1].length - 1] === "\r"
              ? datarow[1].slice(0, -1)
              : datarow[1];
          var val1 = datarow[0];
          var val2 = datarow[1];
          console.log(dataArray);
          switch (val1) {
            case "type":
              if (val2 === "rent") {
                obj.preference.value = "R";
              } else if (val2 === "sale") {
                obj.preference.value = "S";
              } else if (val2 === "P") {
                obj.preference.value = "P";
              }
              break;
            case "propertySubType":
              if (val2 === "residential") {
                obj.resCom.value = "R";
              } else if (val2 === "commercial") {
                obj.resCom.value = "C";
              }
              break;
            case "superPropertyType":
              if (
                val2 === "Retail" ||
                val2 === "Office" ||
                val2 === "Land" ||
                val2 === "Hospitality" ||
                val2 === "Storage" ||
                val2 === "Others" ||
                val2 === "Industry"
              ) {
                obj.superPropertyType.value = val2;
              } else if (val2 === "apartment") {
                obj.superPropertyType.value = 1;
              } else if (val2 === "independenthouse") {
                obj.superPropertyType.value = 2;
              } else if (val2 === "builderfloor") {
                obj.superPropertyType.value = 4;
              } else if (val2 === "studioapartment") {
                obj.superPropertyType.value = 90;
              } else if (val2 === "servicedapartment") {
                obj.superPropertyType.value = 22;
              } else if (val2 === "farmhouse") {
                obj.superPropertyType.value = 5;
              } else if (val2 === "other") {
                obj.superPropertyType.value = 81;
              }
              break;
            case "city":
              obj.city.value.label = datarow[1];
              obj.city.value.id = "0";
              obj.city.value.lat = "";
              obj.city.value.lng = "";
              break;
            case "state":
              if (val2 === "tamilnadu") {
                obj.locationState.value.label = "Tamil Nadu";
                obj.locationState.value.id = "194";
                obj.locationState.value.lat = 11.57691;
                obj.locationState.value.lng = 78.68408;
                obj.latLng.value.lat = 11.57691;
                obj.latLng.value.lng = 78.68408;
                obj.latLng.value.field = "city";
              } else if (val2 === "kerala") {
                obj.locationState.value.label = "Kerala";
                obj.locationState.value.id = "139";
                obj.locationState.value.lat = 9.31899;
                obj.locationState.value.lng = 76.50879;
                obj.latLng.value.lat = 9.31899;
                obj.latLng.value.lng = 76.50879;
                obj.latLng.value.field = "city";
              } else if (val2 === "karnataka") {
                obj.locationState.value.label = "Karnataka";
                obj.locationState.value.id = "127";
                obj.locationState.value.lat = 14.78551;
                obj.locationState.value.lng = 75.79468;
                obj.latLng.value.lat = 14.78551;
                obj.latLng.value.lng = 75.79468;
                obj.latLng.value.field = "city";
              } else if (val2 === "andhrapradesh") {
                obj.locationState.value.label = "Andhra Pradesh";
                obj.locationState.value.id = "64";
                obj.locationState.value.lat = 16.46769;
                obj.locationState.value.lng = 78.65112;
                obj.latLng.value.lat = 16.46769;
                obj.latLng.value.lng = 78.65112;
                obj.latLng.value.field = "city";
              } else if (val2 === "telangana") {
                obj.locationState.value.label = "Telangana";
                obj.locationState.value.id = "1042906";
                obj.locationState.value.lat = 17.864173;
                obj.locationState.value.lng = 79.240416;
                obj.latLng.value.lat = 17.864173;
                obj.latLng.value.lng = 79.240416;
                obj.latLng.value.field = "city";
              } else {
                obj.locationState.value.label = val2;
                obj.locationState.value.id = "0";
                obj.locationState.value.lat = "";
                obj.locationState.value.lng = "";
              }
              break;
            case "subLocality":
              obj.subLocality.value.label = datarow[1];
              obj.subLocality.value.id = "0";
              obj.subLocality.value.lat = "";
              obj.subLocality.value.lng = "";
              break;
            case "locality":
              obj.locality.value.label = datarow[1];
              obj.locality.value.id = "0";
              obj.locality.value.lat = "";
              obj.locality.value.lng = "";
              break;
            case "projectName":
              obj.project.value.label = datarow[1];
              obj.project.value.id = "0";
              obj.project.value.lat = "";
              obj.project.value.lng = "";
              break;
            case "houseNo":
              obj.address.value = val2;
              break;
            case "balconyNum":
              obj.balconyNum.value = val2;
              break;
            case "bathroomNum":
              obj.bathroomNum.value = val2;
              break;
            case "bedroomNum":
              obj.bedroomNum.value = val2;
              break;
            case "carpetArea":
              obj.carpet.value = val2;
              area = parseInt(datarow[1]);
              break;
            case "age":
              if (val2 === "0-1") {
                obj.age.value = "6";
              } else if (val2 === "1-5") {
                obj.age.value = "1";
              } else if (val2 === "5-10") {
                obj.age.value = "2";
              } else if (val2 === "10+") {
                obj.age.value = "3";
              }
              break;
            case "openParking":
              obj.openParking.value = parseInt(datarow[1]);
              break;
            case "coveredParking":
              obj.coveredParking.value = parseInt(datarow[1]);
              break;
            case "totalFloor":
              obj.totalFloor.value = parseInt(datarow[1]);
              break;
            case "floorNum":
              obj.floorNum.value = parseInt(datarow[1]);
              break;
            case "furnished":
              if (datarow[1] === "full") {
                obj.furnish.value = 1;
              } else if (datarow[1] === "semi") {
                obj.furnish.value = 4;
              } else if (datarow[1] === "unfurnished") {
                obj.furnish.value = 2;
              }
              break;
            case "availability":
              if (datarow[1] === "ready to move") {
                obj.propertyAvailability.value = "I";
              } else if (datarow[1] === "under construction") {
                obj.propertyAvailability.value = 5;
              }
              break;
            case "availableYear":
              obj.availability.value = parseInt(datarow[1]);
              break;
            case "availableFor":
              if (datarow[1] === "family") {
                obj.availableFor.value = "1";
              } else if (datarow[1] === "single men") {
                obj.availableFor.value = "2";
              } else if (datarow[1] === "single women") {
                obj.availableFor.value = "3";
              }
              break;
            case "agreement":
              if (datarow[1] === "lease agreement") {
                obj.availableFor.value = "1";
              } else if (datarow[1] === "any") {
                obj.availableFor.value = "2";
              }
              break;
            case "availableMonth":
              obj.availabilityMonth.value = parseInt(datarow[1]);
              break;
            case "availabilityDate":
              regex = /^\d{4}-\d{2}-\d{2}$/;
              regex2 = /^\d{2}-\d{2}-\d{4}$/;
              if (regex.test(datarow[1])) {
                obj.availabilityDate.value = datarow[1];
              } else if (regex2.test(datarow[1])) {
                obj.availabilityDate.value = datarow[1]
                  .split("-")
                  .reverse()
                  .join("-");
              }
              break;
            case "ownership":
              if (datarow[1] === "freehold") {
                obj.ownership.value = 1;
              } else if (datarow[1] === "leasehold") {
                obj.ownership.value = 2;
              } else if (datarow[1] === "co-operative society") {
                obj.ownership.value = 3;
              } else if (datarow[1] === "power of attorney") {
                obj.ownership.value = 4;
              }
              break;
            case "additionalRooms":
              var rooms = datarow[1].split(",");
              for (let i = 0; i < rooms.length; i++) {
                let element = array[i].toLowerCase().trim();
                if (element === "pooja room") {
                  obj.additionalRooms.value.push("1");
                } else if (element === "study room") {
                  obj.additionalRooms.value.push("2");
                } else if (element === "servant room") {
                  obj.additionalRooms.value.push("3");
                } else if (element === "store room") {
                  obj.additionalRooms.value.push("5");
                }
              }
              break;
            case "description":
              obj.description.value = datarow[1];
              obj.description.isAutoGenerated = true;
              break;
            case "price":
              obj.price.value = val2;
              obj.pricePerUnitArea = parseInt(val2) / area;
              break;
            case "tv":
              obj.furnishing_Tv.value = parseInt(val2);
              break;
            case "ac":
              obj.furnishing_Ac.value = parseInt(val2);
              break;
            case "bed":
              obj.furnishing_Bed.value = parseInt(val2);
              break;
            case "fan":
              obj.furnishing_Fan.value = parseInt(val2);
              break;
            case "light":
              obj.furnishing_Light.value = parseInt(val2);
              break;
            case "geyser":
              obj.furnishing_Gey.value = parseInt(val2);
              break;
            case "wardrobe":
              obj.furnishing_Ward.value = parseInt(val2);
            default:
              break;
          }
          localStorage.setItem("ppfData", JSON.stringify(object));
          window.location.reload();
        } catch (error) {
          console.log(error);
        }
      });
    };
  });
});
